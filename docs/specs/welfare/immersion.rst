.. _welfare.specs.immersion:

===================
Immersion trainings
===================

.. How to test only this document:

    $ python setup.py test -s tests.SpecsTests.test_immersion
    
    doctest init:

    >>> from __future__ import print_function,unicode_literals
    >>> import os
    >>> os.environ['DJANGO_SETTINGS_MODULE'] = \
    ...    'lino_book.projects.mathieu.settings.doctests'
    >>> from lino.api.doctest import *

This document describes the :mod:`lino_welfare.modlib.immersion`
plugin.


.. contents::
   :depth: 2



Configuration
=============

A system administrator can select :menuselection:`Configure -->
Integration --> Immersion training types`  to configure the list of
"immersion training types" (:class:`immersion.ContractType
<lino_welfare.modlib.immersion.models.ContractType>`).

The default data for this table is generated by the :mod:`std
<lino_welfare.modlib.immersion.fixtures.std>` fixture:

>>> rt.show(immersion.ContractTypes)
... #doctest: +ELLIPSIS +NORMALIZE_WHITESPACE +REPORT_UDIFF
=========================== =========================== ===================== ===================== ================
 Désignation                 Désignation (de)            Désignation (en)      Régime d'évaluation   Modèle
--------------------------- --------------------------- --------------------- --------------------- ----------------
 MISIP                       MISIP                       MISIP                                       Default.odt
 Mise en situation interne   Mise en situation interne   Internal engagement                         Default.odt
 Stage d'immersion           Stage d'immersion           Immersion training                          StageForem.odt
=========================== =========================== ===================== ===================== ================
<BLANKLINE>


Demo data
=========

:class:`lino_welfare.modlib.immersion.models.Contract`

>>> rt.show(immersion.Contracts)
... #doctest: +ELLIPSIS +NORMALIZE_WHITESPACE +REPORT_UDIFF
==== ========================= ===================== ================== ============ ================= ===========================
 ID   Bénéficiaire              Organisation          Début de contrat   Fin prévue   Titulaire (ISP)   Type de stage d'immersion
---- ------------------------- --------------------- ------------------ ------------ ----------------- ---------------------------
 1    EMONTS Daniel (128)       Bäckerei Ausdemwald   29/10/2012         21/02/2014   Alicia Allmanns   MISIP
 2    EMONTS Daniel (128)       Bäckerei Mießen       22/02/2014         31/12/2014   Caroline Carnol   Mise en situation interne
 3    HILGERS Hildegard (133)   Rumma & Ko OÜ         03/12/2012         11/10/2013   Alicia Allmanns   Stage d'immersion
 4    LAZARUS Line (144)        Bäckerei Schmitz      07/01/2013         06/02/2013   Alicia Allmanns   MISIP
 5    RADERMACHER Guido (159)   Rumma & Ko OÜ         11/02/2013         06/06/2014   Alicia Allmanns   Mise en situation interne
 6    RADERMACHER Guido (159)   Bäckerei Ausdemwald   07/06/2014         15/04/2015   Mélanie Mélard    Stage d'immersion
==== ========================= ===================== ================== ============ ================= ===========================
<BLANKLINE>


Immersion trainings with external partner
=========================================

French-speaking PCSWs use a custom template imposed by FOREM when
printing immersion trainings with some external partner.

>>> obj = immersion.Contract.objects.get(pk=3)
>>> print(str(obj.company))
Rumma & Ko OÜ
>>> bm = printing.BuildMethods.appyodt
>>> ex = obj.printed_by
>>> print(ex.do_print.bound_action.action.get_print_templates(bm, ex)[0])
... #doctest: +NORMALIZE_WHITESPACE +IGNORE_EXCEPTION_DETAIL +ELLIPSIS
StageForem.odt
